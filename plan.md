阅读这个工程项目，在实际中我发现存在下面几个问题：
1.选择发送图片/视频/音频的时候最多只能选择发送一个，选择第二个的时候就覆盖掉了第一个，这不是我想看到的，我需要实现一次性可以有多个图片等文件。
2检查是否能够发送文本文件比如PDF，MD之类的，如果不能请更新该功能
3在实际中发现，有些模型是会返回图片的，而一旦模型返回了图片（其他没有测试），该聊天记录接下来的输入token就会爆炸达到Mtoken级别，这不是我希望看到的，我希望实现的效果是，不管是我的图片还是模型的图片对token的影响是比较小的，实际中发现由我发送的图片造成的token还比较小可以接受，而一旦模型发送了图片，这个对话都无法推进。我希望你能够改善这一点。
附上返回的图片的格式，
    {
      "role": "assistant",
      "content": "![Generated Image](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABYAAAAMACAIAAAASU1SbAAAAiXpUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAAiZTYwxDgIxDAT7vOKekDjrtV1T0VHwgbtcIiEhgfh/QaDgmGlWW0w6X66n5fl6jNu9p+ULkapDENgzpj+Kl5aFfa6KnYWgSjZjGOiSYRxTY/v8KIijI/rXyc236kHdAK22RvHVummEN+………………91ML0BQ+siou79WmMAAAKHaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+QmTxcHmLKBUdi6n2VsOvwC0NTwN4S7ADAzLGvcQIHMlHKHDRBJPYSghMhijpTitwDQnBCNc0c0QDBn4GZhWdEDDganWCxW3j4QAZZyjQMKeOpogKBafzWu6OnXhNyTXt0iagEmYcUXAaE5Ns6i9JXj1jCetuYO3QNqYsJQHROOCCZDeFDPxPZmNdxD101THPYnYFYTayqq4BhSgkZDQz6mdZXkVabOWAiQoou6taEmcBNzOq2IpEJmJsmd7eUWLSZajVj4t08mwlzNvOmcrlc1A2jMO9TJFQu63Kp20nXu7uXOSV3ZwRknsvucNiVRIdpMtddNjXR1ZqGbuvt82sjz7Mvbf2p3//bh/tdHx499UXtc5C7KPlXCS15lK4QzBJIQQSdBpoZsn7wgBgQIsIcPRcZeVS5i4fxOvaCSntrpZKQvq4LV+tHkSIgXl3yQc4AsLifp1EcHd8RUtgYGar7zZqAIcw64zi7v8XcMnK3JC1N2UAAAAASUVORK5CYII=)"
    }
    有时候还会：
    {
    "role": "assistant",
    "content": "**Reasoning:**\n**Analyzing Consistency of Style**\n\nI am now focused on ensuring the second page of the manga mirrors the first. The plan involves replicating the clean lines, halftone shading, and watercolor coloring. Additionally, I'm working to maintain character consistency.\n\n\n**Implementing Manga Page Two**\n\nI'm currently focused on the details for the second manga page. I've broken it down to style, character consistency, page layout, and content. The page will utilize a four-panel structure with a left-to-right reading order. The content will depict the two characters discussing homework in various shots and I plan on adding clear dialogue boxes with Chinese text.\n\n\n**Verifying Page Compliance**\n\nI'm checking the generated comic page against the initial prompts. The art style from the first page is consistently applied, and character consistency is good. New character interactions feel natural. The composition, perspective, and emotional expression within the four-panel layout align with the input. The text and its placement are accurate.\n\n\n**Confirming Visual Elements**\n\nI'm confirming the page's adherence to the original description. The comic page maintains the previous Japanese school manga style. The main characters look consistent, and the new character interactions are seamless. The four-panel layout's composition, perspectives, and emotional content directly reflect the prompt. Text and its arrangement also match the instructions.\n\n\n\n\n**Response:**\n![Generated Image](data:image/png;base64,
    ……………… +5lNyUGJyzcTBlkz2FC6pHZXYjNQGT9w3zDGjF296DUZTC7Jk9EvTX6IjUxU82HSmRs5JDuDuw2dvPWkeMBYErSByhdAWcG5dmozauFF3inQZOCHgxZ/D/zedM4gU3RMKkOKFqk9yFdOR2aNzmrWsCbC2TRzfKh4K2X0BJ0CWGpDlGo1JrhFFA6DWsD5gJn2n8py2Mvsqn/LYjvWDtsrKfZKgs6BWXrsk2qzpE84R/KHaRdtQzZzwl2IL8rJoKFpHbLG3roLZ7sL2LdSzMIf2cGoLzdSR2pc5AuGjNEV6pSPtI3oBuLu1aWhMz6Wjve4j93fTwEIR8cLTAKiTXRAX9xSJ2I6WfCbgF0+Cv0pUlbrjC0Y3ujRAR/xsVbQW4SWp8ZzEjkFxwKLqFggekiBdSJUb8vz4+aTP1QIs4jqT+g+go684pfeCUEfD8Tl5YBKbqSElqTpwSv/7hPOG7MxiwfcCqmsSgPYrbojDbDe66Q6/3Hr3ZjbmbK27X5vZmCqJesL/u05mHegUYm9r79eKtAH8rLc+s/5N6By/BPVPYkWrK6PjgDoV9zF4clCD7IKYz0p3kkhB3jMFEc3Z4v59o4N9rj27ud+RXoXNqeFmLY5/hGbajIpAUMJEM5/sEt7cHSxiaHD3/w9fn2vdZ8lfVAAAAABJRU5ErkJggg==)"
    }
请你基于此帮我修改代码，严格按照要求